- hosts: raspberry
  vars:
    no_proxy: '127.0.0.1,localhost,.local,169.254.169.254'
  remote_user: pi
  tasks:
    - name: execute |Â hosts
      set_fact:
        myget_args: '{{ hostvars[inventory_hostname] }}'
    - name: Proxy Defined
      debug:
        msg: '{{ myget_args }}'

    - name: Main
      block:
        - name: main | execute | run things
          debug:
            msg: '{{ myget_args }}'

      always:
        - name: main | always | remove temporary working directory
          file:
            path  : "{{ work_dir }}"
            state : absent
          delegate_to: localhost

      rescue:
        - name: notify slack of deploy failure
          local_action:
            module: slack
            token: "{{slack_token}}"
            msg: "Deploy failed on {{inventory_hostname}}"